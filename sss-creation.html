<!DOCTYPE html>
<html>
	<!-- Compiled and minified CSS -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">

	<!-- Compiled and minified JavaScript for Materialize CSS -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
	<!-- CSV to JSON -->
	<script src="https://cdn.rawgit.com/Keyang/node-csvtojson/d41f44aa/browser/csvtojson.min.js"></script>

	<style media="screen">
		.container {
			position: relative;
			text-align: center;
			display: flex;
			justify-content: center;
			align-items: center;

			color: white;
		}

		.container-card-display {
			postion: relative;
			text-align: center;
			display: flex;
		    justify-content: center;
		    align-items: center;
			width: 100%;
		}

		.image-assets {
			position: absolute;
			top: 2450px;
			/* top: 282%; */
			bottom 50%;
			/* width: 810px; */
			width: 33%;
		}

		.card-super-image {
			width: 100%;
		}

		@media only screen and (max-width: 1000px) and (min-width: 600px) {
			.image-assets {
				top: 2550px;
				width: 50%;
			}
		}

		@media only screen and (max-width: 600px) {
			.image-assets {
				top: 2650px;
				width: 90%;
			}
		}

	</style>


<body>
	<!-- CREATE SUPER -->
	<div class="row">
		<!-- <h2 style="text-align: center">Create Your Super</h2> -->
		<br>

		<!-- SUPER NAME -->
		<div class="col s12" style="text-align: center;">
			<h4 style="color: red;">Super Name</h4>
			<br>
		</div>
		<div class="col s3"></div>
		<div class="col s6">
			<input id="super_name" value="None"></input>
		</div>
		<div class="col s3"></div>
		<br>
		<div class="col s12">
			<br><br>
			<hr>
		</div>

		<!-- ALIGNMENT -->
		<div class="col s12" style="text-align: center;">
			<h4 style="color: red;">Alignment</h4>
			<br>
			<h5 id="alignment" class="">Hero</h5>
			<br>
		</div>
		<div class="col s7"></div>
		<!-- BUTTONS -->
		<div class="col s12">
			<div class="col s6" style="text-align: center;">
				<button class="waves-effect waves-light btn blue" style=" width: 50%; text-align: center" onclick="alignmenthero(this)" type="button">Hero</button>
			</div>
			<div class="col s6" style="text-align: center;">
				<button class="waves-effect waves-light btn blue" style=" width: 50%; text-align: center" onclick="alignmentvillain(this)" type="button">Villain</button>
			</div>
		</div>
	</div>
	<br><br>
	<hr>

	<div class="row">
		<div class="col s12" style="text-align: center;">
			<h4 style="color: red;">Ability & Defense</h4>
			<br>
		</div>
		<div class="col s4"></div>
		<div class="col s4">
			<h3 style="text-align: center;">Power: <span id="super_power_value">8</span></h3>
		</div>
		<div class="col s4"></div>
		<div class="col s6">
			<div>
				<h4>Name Your Ability</h4>
				<input id="ability_name" value="None"></input>
			</div>
			<div>
				<h4>Selected Ability</h4>
				<h5>Type: <span id="selected_ability_type">None</span></h5>
				<h5>Category: <span id="selected_ability_category">None</span></h5>
				<h6>Effect: <span id="selected_ability_effect">None</span></h6>
			</div>

			<!-- Modal Trigger -->
			<a class="waves-effect waves-light btn modal-trigger" href="#modal-ability" >Select Ability</a>

			<p id="selected_filter_ability_skill_type" style="visibility: hidden">None</p>
			<p id="selected_filter_ability_skill_category" style="visibility: hidden">None</p>
			<p id="selected_ability_skill_id" style="visibility: hidden">18</p>
			<p id="selected_ability_power_add" style="visibility: hidden">4</p>
		</div>
		<div class="col s6">
			<div>
				<h4>Name Your Defense</h4>
				<input id="defense_name" value="None"></input>
			</div>
			<div>
				<h4>Selected Defense</h4>
				<h5>Type: <span id="selected_defense_type">None</span></h5>
				<h5>Category: <span id="selected_defense_category">None</span></h5>
				<h6>Effect: <span id="selected_defense_effect">None</span></h6>
			</div>

			<!-- Modal Trigger -->
			<a class="waves-effect waves-light btn modal-trigger" href="#modal-defense">Select Defense</a>

			<p id="selected_filter_defense_skill_type" style="visibility: hidden">None</p>
			<p id="selected_filter_defense_skill_category" style="visibility: hidden">None</p>
			<p id="selected_defense_skill_id" style="visibility: hidden">17</p>
			<p id="selected_defense_power_add" style="visibility: hidden">4</p>
		</div>
		<div class="col s12" style="text-align: center;">
			<div id="alignment_ability_tied" style="color: red;"></div>
			<br>
			<div id="alignment_defense_tied" style="color: red;"></div>
			<br>
			<div id="skill_buffs" style="color: green;"></div>
			<br>
			<div id="unique_combo" style="color: purple;"></div>
			<br>
		</div>
	</div>

	<!-- ABILITY MODAL -->
	<div id="modal-ability" class="modal">
		<div class="modal-content">
			<h4>Select Ability</h4>
			<div class="input-field col s6">
				<select id="ability_type_selection">
					<option value="All">All</option>
					<option value="Delayed">Delayed</option>
					<option value="Instant">Instant</option>
					<option value="None">None</option>
					<option value="Offensive">Offensive</option>
					<option value="Trigger">Trigger</option>
				</select>
				<label>Type</label>
			</div>
			<div class="input-field col s6">
				<select id="ability_category_selection">
					<option value="All">All</option>
					<option value="Discard">Discard</option>
					<option value="Draw">Draw</option>
					<option value="Flip">Flip</option>
					<option value="Increase Power">Increase Power</option>
					<option value="Negate">Negate</option>
					<option value="None">None</option>
				</select>
				<label>Category</label>
			</div>

			<div class="col s12 m2 push-m2 buttonclass">
				<button class="waves-effect waves-light btn" style="width: 45%; float: center; text-align: center" onclick="ability_filter(this)" type="button">Filter</button>
			<!-- </div>
			<div class="col s6 m2 push-m2 buttonclass"> -->
				<button class="waves-effect waves-light red btn" style="width: 45%; float: center; text-align: center" onclick="reset_filter_ability(this)" type="button">Reset</button>
			</div>
			<p id="all_abilities"></p>

			<br><br><br><br>

		</div>
	</div>

	<!-- DEFENSE MODAL -->
	<div id="modal-defense" class="modal">
		<div class="modal-content">
			<h4>Select Defense</h4>
			<div class="input-field col s6">
				<select id="defense_type_selection">
					<option value="All">All</option>
					<option value="Delayed">Delayed</option>
					<option value="None">None</option>
					<option value="Passive">Passive</option>
					<option value="Trigger">Trigger</option>
				</select>
				<label>Type</label>
			</div>
			<div class="input-field col s6">
				<select id="defense_category_selection">
					<option value="All">All</option>
					<option value="Decrease Power">Decrease Power</option>
					<option value="Discard">Discard</option>
					<option value="Draw">Draw</option>
					<option value="Flip">Flip</option>
					<option value="Increase Power">Increase Power</option>
					<option value="Negate">Negate</option>
					<option value="None">None</option>
					<option value="Return">Return</option>
					<option value="Swap">Swap</option>
				</select>
				<label>Category</label>
			</div>

			<div class="col s12 m2 push-m2 buttonclass">
				<button class="waves-effect waves-light btn" style="width: 45%; float: center; text-align: center" onclick="defense_filter(this)" type="button">Filter</button>
			<!-- </div>
			<div class="col s6 m2 push-m2 buttonclass"> -->
				<button class="waves-effect waves-light red btn" style="width: 45%; float: center; text-align: center" onclick="reset_filter_defense(this)" type="button">Reset</button>
			</div>
			<p id="all_defenses"></p>

			<br><br><br><br>

		</div>
	</div>
	<br><br>
	<hr>

	<div class="row" style="text-align: center;">
		<div class="col s12">
			<h4 style="color: red;">Description Of Your Super</h4>
			<br>
			<!-- SUPER POWERS -->
			<div class="row">
				<div class="col s2"></div>
				<div class="input-field col s8">
					<textarea class="materialize-textarea" id="super_powers_description"></textarea>
					<label for="">Super Powers</label>
				</div>
				<div class="col s2"> </div>
			</div>

			<!-- SUIT COLORS -->
			<div class="row">
				<div class="col s2"></div>
				<div class="input-field col s8">
					<textarea class="materialize-textarea" id="suit_colors_description"></textarea>
					<label for="">Suit Colors</label>
				</div>
				<div class="col s2"></div>
			</div>

			<!-- PHYSICAL FEATURES -->
			<div class="row">
				<div class="col s2"></div>
				<div class="input-field col s8">
					<textarea class="materialize-textarea" id="physical_features_description"></textarea>
					<label for="">Physical Features</label>
				</div>
				<div class="col s2"></div>
			</div>

			<!-- RACE -->
			<div class="row">
				<div class="col s2"></div>
				<div class="input-field col s8">
					<textarea class="materialize-textarea" id="race_description"></textarea>
					<label for="">Race</label>
				</div>
				<div class="col s2"></div>
			</div>

			<!-- GENDER -->
			<div class="row">
				<div class="col s2"></div>
				<div class="input-field col s8">
					<textarea class="materialize-textarea" id="gender_description"></textarea>
					<label for="">Gender</label>
				</div>
				<div class="col s2"></div>
			</div>

		</div>
	</div>
	<br><br>
	<hr>
		<!-- </div> -->

	<br>
	<div class="row"  style="text-align: center">
		<div class="col s12" style="text-align: center;">
			<h4 style="color: red;">Select An Example Image For Display</h4>
			<br>
		</div>

		<!-- Modal Trigger -->
		<a class="waves-effect waves-light btn modal-trigger" href="#modal-select-image">Select Image For Display</a>

		<!-- ABILITY MODAL -->
		<div id="modal-select-image" class="modal">
			<div class="modal-content">
				<h4 style="text-align: center">Select Image</h4>
				<h6 style="text-align: center">Not the image you will use for your character. Only for example use.</h6>

				<p id="confirmed_image_selection"></p>
				<button class="waves-effect waves-light btn red" style="width: 80%; float: center; text-align: center" onclick="remove_example_selection(this)" type="button">Remove Selection</button>
				<br>
				<div class="row">
				    <div class="col s6">
				        <!-- <div class="card blue-grey darken-1"> -->
						<div class="card">
			        	<div class="card-content">
				        	<span class="card-title">Example 1</span>
							<img class="card-super-image" id="example_one" src="https://drive.google.com/uc?export=view&id=13ts_6kOWHgMaKogG10_vsE_uy3doWs31" alt="Super Example 1">
				        </div>
				        <div class="card-action">
							<button class="waves-effect waves-light btn" style="width: 80%; float: center; text-align: center" onclick="select_super_example_one(this)" type="button">Select</button>
				        </div>
				      </div>
				    </div>

					<div class="col s6">
				        <!-- <div class="card blue-grey darken-1"> -->
						<div class="card">
			        	<div class="card-content">
				        	<span class="card-title">Example 2</span>
							<img class="card-super-image" id="example_two" src="https://drive.google.com/uc?export=view&id=1sy1ldf7AFArjQxvwKORyelc97_GtWRHD" alt="Super Example 2">
				        </div>
				        <div class="card-action">
							<button class="waves-effect waves-light btn" style="width: 80%; float: center; text-align: center" onclick="select_super_example_two(this)" type="button">Select</button>
				        </div>
				      </div>
				    </div>

					<div class="col s6">
				        <!-- <div class="card blue-grey darken-1"> -->
						<div class="card">
			        	<div class="card-content">
				        	<span class="card-title">Example 3</span>
							<img class="card-super-image" id="example_three" src="https://drive.google.com/uc?export=view&id=1obpRj_rgKNPYOp-DMf0gLh2PUDFKnnIR" alt="Super Example 3">
				        </div>
				        <div class="card-action">
							<button class="waves-effect waves-light btn" style="width: 80%; float: center; text-align: center" onclick="select_super_example_three(this)" type="button">Select</button>
				        </div>
				      </div>
				    </div>

					<div class="col s6">
				        <!-- <div class="card blue-grey darken-1"> -->
						<div class="card">
			        	<div class="card-content">
				        	<span class="card-title">Example 4</span>
							<img class="card-super-image" id="example_four" src="https://drive.google.com/uc?export=view&id=1_Lub_C1CF8K4wUOPVapv1dfv4H9Jo9Ah" alt="Super Example 4">
				        </div>
				        <div class="card-action">
							<button class="waves-effect waves-light btn" style="width: 80%; float: center; text-align: center" onclick="select_super_example_four(this)" type="button">Select</button>
				        </div>
				      </div>
				    </div>
					<div class="col s6">
				        <!-- <div class="card blue-grey darken-1"> -->
						<div class="card">
			        	<div class="card-content">
				        	<span class="card-title">Example 4</span>
							<img class="card-super-image" id="example_five" src="https://drive.google.com/uc?export=view&id=15eLSXAsvpS7pnmBxcYiDU9ZF5bWPTKtz" alt="Super Example 5">
				        </div>
				        <div class="card-action">
							<button class="waves-effect waves-light btn" style="width: 80%; float: center; text-align: center" onclick="select_super_example_five(this)" type="button">Select</button>
				        </div>
				      </div>
				    </div>
					<div class="col s6">
				        <!-- <div class="card blue-grey darken-1"> -->
						<div class="card">
			        	<div class="card-content">
				        	<span class="card-title">Example 4</span>
							<img class="card-super-image" id="example_six" src="https://drive.google.com/uc?export=view&id=1WhcgyByo2Jur5DZPbNLmji27M8WzS-P3" alt="Super Example 6">
				        </div>
				        <div class="card-action">
							<button class="waves-effect waves-light btn" style="width: 80%; float: center; text-align: center" onclick="select_super_example_six(this)" type="button">Select</button>
				        </div>
				      </div>
				    </div>

				  </div>
				<br>

				<div id="super_image_element" style="visibility: hidden">None</div>

				<br><br><br><br>

			</div>
		</div>

		<br><br>
		<div class="col s2"></div>
		<div class="container-card-display col s8" id="card_display_layout"></div>
	</div>

	<div class="row">
		<div class="col s4"></div>
		<div class="col s4">
			<button class="waves-effect waves-light btn" style="width: 100%; float: center; text-align: center" onclick="display_super(this)" type="button">Display</button>
			<br>
			<p style="color:red;">* Does not display your Super Name, Ability Name and Defense Name.</p>
		</div>
		<div class="col s4"></div>
		<!-- inputs for 1. main suit colors, 2. describe super powers, 3. gender, 4. describe physical features, 5. other additional information -->
	</div>

	<br><br><br><br>

	<script type="text/javascript">

		const alignments = ["Hero", "Villain"];

		// CREATE CARD ASSETS
		const base_card = "https://drive.google.com/uc?export=view&id=1pcvbGcktqmoXuMu547BtH8A_25gUPDOT";

		// GOOGLE SHEETS URL
		let url_abilities_defenses = "https://docs.google.com/spreadsheets/d/17hmcKte-Bx573Ce4-0y6BC3BX6rF8Y2QiyDNNMmx_78/export?format=csv";
		let url_create_card_assets = "https://docs.google.com/spreadsheets/d/1EsQJtOvSWhus9-tmgvwqv2ndYt5LXsgqSgwo2IHxPGk/export?format=csv";

		// ALIGNMENT SELECTION
		const alignmenthero = control => {
			// ability
			let ability_power = document.getElementById("selected_ability_power_add").textContent;
			let ability_id = document.getElementById("selected_ability_skill_id").textContent;
			let ability_type = document.getElementById("selected_ability_type").textContent;
			let ability_category = document.getElementById("selected_ability_category").textContent;

			// defense
			let defense_power = document.getElementById("selected_defense_power_add").textContent;
			let defense_id = document.getElementById("selected_defense_skill_id").textContent;
			let defense_type = document.getElementById("selected_defense_type").textContent;
			let defense_category = document.getElementById("selected_defense_category").textContent;

			// power adjustment
			let final_power_val = 0;

			document.getElementById("alignment").innerHTML = alignments[0];
			console.log("Set alignment to \"" + alignments[0] + "\".");

			// re-calculate power
			final_power_val = power_calculator(ability_id, ability_power, ability_type, ability_category, "Ability");
			final_power_val = power_calculator(defense_id, defense_power, defense_type, defense_category, "Defense");

			document.getElementById("super_power_value").innerHTML = Math.round(final_power_val);
		}

		const alignmentvillain = control => {
			// ability
			let ability_power = document.getElementById("selected_ability_power_add").textContent;
			let ability_id = document.getElementById("selected_ability_skill_id").textContent;
			let ability_type = document.getElementById("selected_ability_type").textContent;
			let ability_category = document.getElementById("selected_ability_category").textContent;

			// defense
			let defense_power = document.getElementById("selected_defense_power_add").textContent;
			let defense_id = document.getElementById("selected_defense_skill_id").textContent;
			let defense_type = document.getElementById("selected_defense_type").textContent;
			let defense_category = document.getElementById("selected_defense_category").textContent;

			document.getElementById("alignment").innerHTML = alignments[1];
			console.log("Set alignment to \"" + alignments[1] + "\".");

			// re-calculate power
			final_power_val = power_calculator(ability_id, ability_power, ability_type, ability_category, "Ability");
			final_power_val = power_calculator(defense_id, defense_power, defense_type, defense_category, "Defense");

			document.getElementById("super_power_value").innerHTML = Math.round(final_power_val);
		}

		// ABILITY FILTER BUTTON
		const ability_filter = control => {
			let set_ab_type_selected = ""; // Resets to blank before setting
			let set_ab_category_selected = ""; // Resets to blank before setting
			let ab_type_selected;
			let ab_category_selected;
			let ability_skills = [];
			let ability_skill_list = [];

			set_ab_type_selected = document.getElementById("ability_type_selection").options[ability_type_selection.selectedIndex].text;
			set_ab_category_selected = document.getElementById("ability_category_selection").options[ability_category_selection.selectedIndex].text;

			document.getElementById("selected_filter_ability_skill_type").innerHTML = set_ab_type_selected;
			document.getElementById("selected_filter_ability_skill_category").innerHTML = set_ab_category_selected;

			ab_type_selected = document.getElementById("selected_filter_ability_skill_type").textContent;
			ab_category_selected = document.getElementById("selected_filter_ability_skill_category").textContent;
			// console.log(ab_type_selected);
			// console.log(ab_category_selected);

			// Fetch Abilities and set into Array
			fetch(url_abilities_defenses).then(result=>result.text()).then(function(csvtext) {
				return csv().fromString(csvtext);
			}).then(function(csv) {
				csv.forEach(function(row) {

					// set selected abilities based on filter
					if (row.skill_type != 'Defense') {
						if (ab_type_selected == 'All' && ab_category_selected == 'All') {
							ability_skills.push(row);
						} else if (ab_type_selected == row.type && ab_category_selected == row.category) {
							ability_skills.push(row);
						} else if (ab_type_selected == 'All' && ab_category_selected == row.category){
							ability_skills.push(row);
						} else if (ab_type_selected == row.type && ab_category_selected == 'All'){
							ability_skills.push(row);
						}
					}
				});

				// reset display area
				document.getElementById("all_abilities").innerHTML = ""

				// display based on selected type and category
				for (i=0; i <= ability_skills.length; i++) {
					document.getElementById("all_abilities").innerHTML += "<br><b>Type:</b> "
						+ ability_skills[i].type
						+ "<br><b>Category:</b> "
						+ ability_skills[i].category
						+ "<div><b>Effect:</b> "
						+ ability_skills[i].effects
						+ " <br><button class=\"waves-effect blue waves-light btn\" onclick=\"ability_selected("
						+ ability_skills[i].id
						+ ")\" type=\"button\">Select</button></div><hr>";
				}
			});
		}

		const ability_selected = ability_id => {
			// console.log(ability_id);
			let selected_ability_id = "";
			let selected_ability_effect = "";
			let selected_ability_type = "";
			let selected_ability_category = "";
			let selected_ability_power_add = "";
			let ability_power = "";

			fetch(url_abilities_defenses).then(result=>result.text()).then(function(csvtext) {
				return csv().fromString(csvtext);
			}).then(function(csv) {
				csv.forEach(function(row) {

					// set selected abilities based on filter
					if (row.id == ability_id && row.skill_type != "Defense") {
						selected_ability_id = row.id;
						selected_ability_effect = row.effects;
						selected_ability_type = row.type;
						selected_ability_category = row.category;
						selected_ability_power_add = row.power_add;
					}
				});

				// display selected on non-modal
				document.getElementById("selected_ability_type").innerHTML = selected_ability_type;
				document.getElementById("selected_ability_category").innerHTML = selected_ability_category;
				document.getElementById("selected_ability_effect").innerHTML = selected_ability_effect;
				document.getElementById("skill_buffs").innerHTML = "";
				// hidden values
				document.getElementById("selected_ability_skill_id").innerHTML = selected_ability_id;
				document.getElementById("selected_ability_power_add").innerHTML = selected_ability_power_add;
				// update power
				ability_power = selected_ability_power_add;
				// console.log(ability_power);

				final_power_val = power_calculator(selected_ability_id, ability_power, selected_ability_type, selected_ability_category, "Ability");

				document.getElementById("super_power_value").innerHTML = Math.round(final_power_val);

				console.log("Set ability effect to \"" + selected_ability_effect + "\".");
			});
		}

		// DEFENSE FILTER BUTTON
		const defense_filter = control => {
			let set_def_type_selected = ""; // Resets to blank before setting
			let set_def_category_selected = ""; // Resets to blank before setting
			let def_type_selected;
			let def_category_selected;
			let defense_skills = [];
			let defense_skill_list = [];

			set_def_type_selected = document.getElementById("defense_type_selection").options[defense_type_selection.selectedIndex].text;
			set_def_category_selected = document.getElementById("defense_category_selection").options[defense_category_selection.selectedIndex].text;

			document.getElementById("selected_filter_defense_skill_type").innerHTML = set_def_type_selected;
			document.getElementById("selected_filter_defense_skill_category").innerHTML = set_def_category_selected;

			def_type_selected = document.getElementById("selected_filter_defense_skill_type").textContent;
			def_category_selected = document.getElementById("selected_filter_defense_skill_category").textContent;
			// console.log(ab_type_selected);
			// console.log(ab_category_selected);

			// Fetch Abilities and set into Array
			fetch(url_abilities_defenses).then(result=>result.text()).then(function(csvtext) {
				return csv().fromString(csvtext);
			}).then(function(csv) {
				csv.forEach(function(row) {

					// set selected abilities based on filter
					if (row.skill_type != 'Ability') {
						if (def_type_selected == 'All' && def_category_selected == 'All') {
							defense_skills.push(row);
						} else if (def_type_selected == row.type && def_category_selected == row.category) {
							defense_skills.push(row);
						} else if (def_type_selected == 'All' && def_category_selected == row.category){
							defense_skills.push(row);
						} else if (def_type_selected == row.type && def_category_selected == 'All'){
							defense_skills.push(row);
						}
					}
				});

				// reset display area
				document.getElementById("all_defenses").innerHTML = "";

				// display based on selected type and category
				for (i=0; i <= defense_skills.length; i++) {
					document.getElementById("all_defenses").innerHTML += "<br><b>Type:</b> "
						+ defense_skills[i].type
						+ "<br><b>Category:</b> "
						+ defense_skills[i].category
						+ "<div><b>Effect:</b> "
						+ defense_skills[i].effects
						+ " <br><button class=\"waves-effect blue waves-light btn\" onclick=\"defense_selected("
						+ defense_skills[i].id
						+ ")\" type=\"button\">Select</button></div><hr>";
				}

			});
		}

		const defense_selected = defense_id => {
			// console.log(ability_id);
			let selected_defense_id = "";
			let selected_defense_effect = "";
			let selected_defense_type = "";
			let selected_defense_category = "";
			let selected_defense_power_add = "";
			let ability_power = document.getElementById("selected_ability_power_add").textContent;
			let defense_power = "";
			// let super_power_val = 0;
			// let adjusted_defense_power = 0;
			// let adjust_super_power_val = 0;
			// let alignment = document.getElementById("alignment").textContent;
			// let ability_type = document.getElementById("selected_ability_type").textContent;
			// let synergy_boost = 1.05;
			let final_power_val = 0;
			// let ability_category = document.getElementById("selected_ability_category").textContent;
			// let ability_id = document.getElementById("selected_ability_skill_id").textContent;


			fetch(url_abilities_defenses).then(result=>result.text()).then(function(csvtext) {
				return csv().fromString(csvtext);
			}).then(function(csv) {
				csv.forEach(function(row) {

					// set selected abilities based on filter
					if (row.id == defense_id && row.skill_type != "Ability") {
						selected_defense_id = row.id;
						selected_defense_effect = row.effects;
						selected_defense_type = row.type;
						selected_defense_category = row.category;
						selected_defense_power_add = row.power_add;
					}
				});

				// display selected on non-modal
				document.getElementById("selected_defense_type").innerHTML = selected_defense_type;
				document.getElementById("selected_defense_category").innerHTML = selected_defense_category;
				document.getElementById("selected_defense_effect").innerHTML = selected_defense_effect;
				// hidden values
				document.getElementById("selected_defense_skill_id").innerHTML = selected_defense_id;
				document.getElementById("selected_defense_power_add").innerHTML = selected_defense_power_add;
				// update power
				defense_power = selected_defense_power_add;
				// console.log(defense_power);

				final_power_val = power_calculator(selected_defense_id, defense_power, selected_defense_type, selected_defense_category, "Defense");

				document.getElementById("super_power_value").innerHTML = Math.round(final_power_val);

				console.log("Set defense effect to \"" + selected_defense_effect + "\".");
			});
		}

		const power_calculator = (skill_id, skill_power, skill_type, skill_category, skill_ability_defense) => {
			// alignment
			let alignment = document.getElementById("alignment").textContent;

			// ability
			let ability_power = document.getElementById("selected_ability_power_add").textContent;
			let ability_id = document.getElementById("selected_ability_skill_id").textContent;
			let ability_type = document.getElementById("selected_ability_type").textContent;
			let ability_category = document.getElementById("selected_ability_category").textContent;

			// defense
			let defense_power = document.getElementById("selected_defense_power_add").textContent;
			let defense_id = document.getElementById("selected_defense_skill_id").textContent;
			let defense_type = document.getElementById("selected_defense_type").textContent;
			let defense_category = document.getElementById("selected_defense_category").textContent;

			// power values
			let adjusted_ability_power = 0; // reset to 0
			let adjusted_defense_power = 0; // reset to 0
			let super_power_val = 0; // reset to 0
			let adjusted_super_power_val = 0; // reset to 0
			let synergy_boost = 1.1;
			let final_power_val = 0; // reset to 0

			// Ability v. Defense skills
			if (skill_ability_defense == "Ability") {
				// set new ability selected
				ability_id = skill_id;
				ability_power = skill_power;
				ability_type = skill_type;
				ability_category = skill_category;

				// ABILITY - Hero v. Villain
				if (alignment == "Hero") {
					// villain abilities
					if (ability_id == 32 || ability_id == 34) {
						adjusted_ability_power = ability_power * 0.5;
						document.getElementById("alignment_ability_tied").innerHTML = "*Ability Power Decrease Due To Alignment -50%*";
					} else {
						adjusted_ability_power = ability_power;
						document.getElementById("alignment_ability_tied").innerHTML = "";
					}
				} else if (alignment == "Villain") {
					// hero abilities
				if (ability_id == 31 || ability_id == 33) {
						adjusted_ability_power = ability_power * 0.5;
						document.getElementById("alignment_ability_tied").innerHTML = "*Ability Power Decrease Due To Alignment -50%*";
					} else {
						adjusted_ability_power = ability_power;
						document.getElementById("alignment_ability_tied").innerHTML = "";
					}
				}

				console.log(adjusted_ability_power);

				super_power_val = parseFloat(adjusted_ability_power) + parseFloat(defense_power);

				console.log(super_power_val);

			} else if (skill_ability_defense == "Defense") {
				// set new ability selected
				defense_id = skill_id;
				defense_power = skill_power;
				defense_type = skill_type;
				defense_category = skill_category;

				if (alignment == "Hero") {
					// villain defense
					if (defense_id == 27 || defense_id == 29) {
						adjusted_defense_power = defense_power * 0.5;
						document.getElementById("alignment_defense_tied").innerHTML = "*Defense Power Decrease Due To Alignment -50%*";
					} else {
						adjusted_defense_power = defense_power;
						document.getElementById("alignment_defense_tied").innerHTML = "";
					}
				} else if (alignment == "Villain") {
					// hero defense
					if (defense_id == 26 || defense_id == 28) {
						adjusted_defense_power = defense_power * 0.5;
						document.getElementById("alignment_defense_tied").innerHTML = "*Defense Power Decrease Due To Alignment -50%*";
					} else {
						adjusted_defense_power = defense_power;
						document.getElementById("alignment_defense_tied").innerHTML = "";
					}
				}

				console.log(adjusted_defense_power);

				super_power_val = parseFloat(ability_power) + parseFloat(adjusted_defense_power);

				console.log(super_power_val);
			}
			console.log(ability_id + " " + defense_id);

			// Unique combo calculations
			if (ability_type == "None" && defense_id == 8) {
				adjusted_super_power_val = super_power_val * 1.2;
				document.getElementById("unique_combo").innerHTML = "*Unique Combo Power Boost - \"Achilles Heel\" +15%*";
			} else if (ability_type == "None" && defense_type == "None") {
				adjusted_super_power_val = super_power_val * 1.1;
				document.getElementById("unique_combo").innerHTML = "*Unique Combo Power Boost - \"Just Power\" +10%*";
			} else if (ability_id == 16 && defense_id == 4) {
				adjusted_super_power_val = super_power_val * 2;
				document.getElementById("unique_combo").innerHTML = "*Unique Combo Power Boost - \"Polar Opposites\" +100%*";
			} else if (ability_id == 30 && defense_id == 19) {
				adjusted_super_power_val = super_power_val * 1.2;
				document.getElementById("unique_combo").innerHTML = "*Unique Combo Power Boost - \"Double Trigger Flip\" +20%*";
			} else if (ability_id == 33 && defense_id == 26) {
				adjusted_super_power_val = super_power_val * 1.15;
				document.getElementById("unique_combo").innerHTML = "*Unique Combo Power Boost - \"Anti-Villain\" +15%*";
			} else if (ability_id == 34 && defense_id == 27) {
				adjusted_super_power_val = super_power_val * 1.15;
				document.getElementById("unique_combo").innerHTML = "*Unique Combo Power Boost - \"Anti-Hero\" +15%*";
			} else if (ability_id == 12 && defense_id == 12) {
				adjusted_super_power_val = super_power_val * 2;
				document.getElementById("unique_combo").innerHTML = "*Unique Combo Power Boost - \"The Tactician\" +100%*";
			} else if (ability_id == 25 && defense_id == 2) {
				adjusted_super_power_val = super_power_val * 1.25;
				document.getElementById("unique_combo").innerHTML = "*Unique Combo Power Boost - \"Team Fighter\" +25%*";
			} else if (super_power_val > 7) {
				adjusted_super_power_val = super_power_val * 0.92;
				document.getElementById("unique_combo").innerHTML = "";
			} else if (super_power_val > 5 && super_power_val <= 7) {
				adjusted_super_power_val = super_power_val * 0.95;
				document.getElementById("unique_combo").innerHTML = "";
			} else if (super_power_val <= 2) {
				adjusted_super_power_val = super_power_val * 1.1;
				document.getElementById("unique_combo").innerHTML = "";
			} else {
				adjusted_super_power_val = super_power_val;
				document.getElementById("unique_combo").innerHTML = "";
			}

			console.log(adjusted_super_power_val);

			// Skill Category Synergy
			if (ability_category == defense_category) {
				final_power_val = (adjusted_super_power_val * synergy_boost) * 0.85;
				document.getElementById("skill_buffs").innerHTML = "*Ability & Defense Synergy Power Boost +10%*";
			} else {
				final_power_val = (adjusted_super_power_val * 0.85);
				document.getElementById("skill_buffs").innerHTML = "";
			}
			console.log(final_power_val);

			return final_power_val;
		}


		const reset_filter_ability = control => {
			document.getElementById("all_abilities").innerHTML = "";
		}

		const reset_filter_defense = control => {
			document.getElementById("all_defenses").innerHTML = "";
		}

		const select_super_example_one = control => {
			console.log("Example 1 selected.");
			document.getElementById("super_image_element").innerHTML = document.getElementById("example_one").src;
			document.getElementById("confirmed_image_selection").innerHTML = "Example 1 selected."
		}

		const select_super_example_two = control => {
			console.log("Example 2 selected.");
			document.getElementById("super_image_element").innerHTML = document.getElementById("example_two").src;
			document.getElementById("confirmed_image_selection").innerHTML = "Example 2 selected."
		}

		const select_super_example_three = control => {
			console.log("Example 3 selected.");
			document.getElementById("super_image_element").innerHTML = document.getElementById("example_three").src;
			document.getElementById("confirmed_image_selection").innerHTML = "Example 3 selected."
		}

		const select_super_example_four = control => {
			console.log("Example 4 selected.");
			document.getElementById("super_image_element").innerHTML = document.getElementById("example_four").src;
			document.getElementById("confirmed_image_selection").innerHTML = "Example 4 selected."
		}

		const select_super_example_five = control => {
			console.log("Example 5 selected.");
			document.getElementById("super_image_element").innerHTML = document.getElementById("example_five").src;
			document.getElementById("confirmed_image_selection").innerHTML = "Example 5 selected."
		}

		const select_super_example_six = control => {
			console.log("Example 6 selected.");
			document.getElementById("super_image_element").innerHTML = document.getElementById("example_six").src;
			document.getElementById("confirmed_image_selection").innerHTML = "Example 6 selected."
		}

		const remove_example_selection = control => {
			console.log("Removed selection.");
			document.getElementById("super_image_element").innerHTML = "None";
			document.getElementById("confirmed_image_selection").innerHTML = "Removed selection."
		}


		const display_super = control => {
			let super_name = document.getElementById("super_name").value;
			let alignment = document.getElementById("alignment").textContent;
			let ability_name = document.getElementById("ability_name").value;
			let ability_type = document.getElementById("selected_ability_type").textContent;
			let ability_effect = document.getElementById("selected_ability_effect").textContent;
			let defense_name = document.getElementById("defense_name").value;
			let defense_type = document.getElementById("selected_defense_type").textContent;
			let defense_effect = document.getElementById("selected_defense_effect").textContent;
			let power = document.getElementById("super_power_value").textContent;
			let ability_id = document.getElementById("selected_ability_skill_id").textContent;
			let defense_id = document.getElementById("selected_defense_skill_id").textContent;

			let card_asset_items = [];
			let image_tag_start = "<img src=\"";
			let image_tag_end = "\" alt=\"card example template - create version\" class=\"image-assets\">";
			let card_base_layout;
			let card_example_label;
			let card_gray_backgound;
			let set_card_asset_alignment;
			let set_card_asset_power_value;
			let set_card_asset_ability_type;
			let set_card_asset_defense_type;
			let set_super_name;
			let set_ability_name;
			let set_ability_effect;
			let set_defense_name;
			let set_defense_effect;
			let set_image_example;
			let super_name_base;

			// reset card display
			document.getElementById("card_display_layout").innerHTML = "";

			// card_display_layout
			fetch(url_create_card_assets).then(result=>result.text()).then(function(csvtext) {
				return csv().fromString(csvtext);
			}).then(function(csv) {
				csv.forEach(function(row) {

					card_asset_items.push(row);

				});

				// SET CARD ASSETS
				// IMAGE EXAMPLE
				if (document.getElementById("super_image_element").textContent != "None") {
					set_image_example = image_tag_start
						+ document.getElementById("super_image_element").textContent
						+ image_tag_end;
					// console.log(set_image_example);
				} else {
					set_image_example = "";
				}

				// CARD TEMPLATE
				card_base_layout = image_tag_start
					+ card_asset_items[0].asset_image
					+ image_tag_end;

				// GRAY BACKGOUND
				card_gray_backgound = image_tag_start
					+ card_asset_items[1].asset_image
					+ image_tag_end;

				super_name_base = image_tag_start
					+ card_asset_items[3].asset_image
					+ image_tag_end;

				// EXAMPLE LABEL BACKGOUND
				card_example_label = image_tag_start
					+ card_asset_items[2].asset_image
					+ image_tag_end;

				// ALIGNMENT
				for (i=0; i < card_asset_items.length; i++) {
					if (card_asset_items[i].card_asset == "Alignment" && card_asset_items[i].value == alignment) {
						// console.log(card_asset_items[i].asset_image);
						set_card_asset_alignment = image_tag_start
							+ card_asset_items[i].asset_image
							+ image_tag_end;
					}
				};

				// POWER VALUE
				for (i=0; i < card_asset_items.length; i++) {
					if (card_asset_items[i].card_asset == "Power Value" && card_asset_items[i].value == power) {
						// console.log(card_asset_items[i].asset_image);
						set_card_asset_power_value = image_tag_start
							+ card_asset_items[i].asset_image
							+ image_tag_end;
					}
				};

				// ABILITY TYPE
				for (i=0; i < card_asset_items.length; i++) {
					if (card_asset_items[i].card_asset == "Ability Type" && card_asset_items[i].value == ability_type) {
						// console.log(card_asset_items[i].asset_image);
						set_card_asset_ability_type = image_tag_start
							+ card_asset_items[i].asset_image
							+ image_tag_end;
					} else if (ability_type == "None") {
						set_card_asset_ability_type = "";
					}
				};

				// DEFENSE TYPE
				for (i=0; i < card_asset_items.length; i++) {
					if (card_asset_items[i].card_asset == "Defense Type" && card_asset_items[i].value == defense_type) {
						// console.log(card_asset_items[i].asset_image);
						set_card_asset_defense_type = image_tag_start
							+ card_asset_items[i].asset_image
							+ image_tag_end;
					} else if (defense_type == "None") {
						set_card_asset_defense_type = "";
					}
				};

				set_super_name = "<div class=\"text-super-name base-card-text\">" + super_name + "</div>";

				// set_ability_name = "<div class=\"skill-card-text base-card-text text-ability-name\">" + ability_name + "</div>";
				if (ability_effect != "None") {
					set_ability_name = "<div class=\"skill-card-text base-card-text text-ability-name\">" + ability_name + "</div>";
				} else { set_ability_name = ""; }

				// set_ability_effect = "<div class=\"skill-card-text base-card-text text-ability-effect\">" + ability_effect + "</div>";
				// if (ability_effect != "None") {
				// 	set_ability_effect = "<div class=\"skill-card-text base-card-text text-ability-effect\">" + ability_effect + "</div>";
				// } else { set_ability_effect = ""; }
				for (i=0; i < card_asset_items.length; i++) {
					if (card_asset_items[i].card_asset == "Ability Effect" && card_asset_items[i].value == ability_id) {
						// console.log(card_asset_items[i].asset_image);
						set_ability_effect = image_tag_start
							+ card_asset_items[i].asset_image
							+ image_tag_end;
					} else if (ability_type == "None") {
						set_ability_effect = "";
					}
				};

				for (i=0; i < card_asset_items.length; i++) {
					if (card_asset_items[i].card_asset == "Defense Effect" && card_asset_items[i].value == defense_id) {
						// console.log(card_asset_items[i].asset_image);
						set_defense_effect = image_tag_start
							+ card_asset_items[i].asset_image
							+ image_tag_end;
					} else if (defense_type == "None") {
						set_defense_effect = "";
					}
				};
				console.log(defense_type);
				// set_defense_name = "<div class=\"skill-card-text base-card-text text-defense-name\">" + defense_name + "</div>";
				// if (defense_effect != "None") {
				// 	set_defense_name = "<div class=\"skill-card-text base-card-text text-defense-name\">" + defense_name + "</div>";
				// } else { set_defense_name = ""; }

				// SETUP CARD
				document.getElementById("card_display_layout").innerHTML = card_gray_backgound;
				document.getElementById("card_display_layout").innerHTML += set_image_example;
				document.getElementById("card_display_layout").innerHTML += card_base_layout;
				document.getElementById("card_display_layout").innerHTML += super_name_base;
				document.getElementById("card_display_layout").innerHTML += set_card_asset_alignment;
				document.getElementById("card_display_layout").innerHTML += set_card_asset_power_value;
				document.getElementById("card_display_layout").innerHTML += set_card_asset_ability_type;
				document.getElementById("card_display_layout").innerHTML += set_card_asset_defense_type;

				// doesn't work as intended due to css
				// document.getElementById("card_display_layout").innerHTML += set_super_name;
				// document.getElementById("card_display_layout").innerHTML += set_ability_name;
				document.getElementById("card_display_layout").innerHTML += set_ability_effect;
				// document.getElementById("card_display_layout").innerHTML += set_defense_name;
				document.getElementById("card_display_layout").innerHTML += set_defense_effect;

				document.getElementById("card_display_layout").innerHTML += card_example_label;


				console.log("Display card generated.");
			});

		}

		// MATERIALIZE CSS
		document.addEventListener('DOMContentLoaded', function() {
		    var elems = document.querySelectorAll('.modal');
		    var instances = M.Modal.init(elems);
		});
		document.addEventListener('DOMContentLoaded', function() {
		    var elems = document.querySelectorAll('select');
		    var instances = M.FormSelect.init(elems);
		});

 	</script>

	</body>

</html>
